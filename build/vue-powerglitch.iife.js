var PowerGlitch=function(c,s){"use strict";var m={};Object.defineProperty(m,"__esModule",{value:!0});var f=m.PowerGlitch=void 0;const d=()=>({backgroundColor:"transparent",hideOverflow:!1,timing:{duration:2*1e3,iterations:1/0},glitchTimeSpan:{start:.5,end:.7},shake:{velocity:15,amplitudeX:.4,amplitudeY:.4},slice:{count:6,velocity:15,minHeight:.02,maxHeight:.15,hueRotate:!0}}),g=(e,n)=>{let t=0;if(e.glitchTimeSpan){const r=e.glitchTimeSpan.start,l=e.glitchTimeSpan.end;if(n<r||n>l)return 0;const i=r+(l-r)/2;n<i?t=(n-r)/(i-r):t=(l-n)/(l-i)}else t=1;return(Math.random()-.5)*2*t},$=({minHeight:e,maxHeight:n,minWidth:t,maxWidth:a})=>{const r=Math.floor(Math.random()*((n-e)*100+1))+e*100,l=Math.floor(Math.random()*((a-t)*100+1))+t*100,i=Math.floor(Math.random()*(100-r)),o=Math.floor(Math.random()*(100-l));return{top:i,left:o,height:r,width:l}},E=({top:e,left:n,height:t,width:a})=>{const r=`${n+a}% ${e}%`,l=`${n+a}% ${e+t}%`,i=`${n}% ${e+t}%`,o=`${n}% ${e}%`;return`polygon(${r}, ${l}, ${i}, ${o})`},u=e=>Object.assign(Object.assign({},d().timing),{easing:`steps(${e}, jump-start)`}),M=e=>{if(!e.slice)throw new Error("Slice are not enabled");const n=Math.floor(e.slice.velocity*e.timing.duration/1e3)+1,t=[];for(let a=0;a<n;++a){const r=$({minHeight:e.slice.minHeight,maxHeight:e.slice.maxHeight,minWidth:1,maxWidth:1}),l=g(e,a/n)*30,i={};i.transform=`translate3d(${l}%, 0, 0)`,i.clipPath=E(r),e.slice.hueRotate&&(i.filter=`hue-rotate(${Math.floor(g(e,a/n)*360)}deg)`),t.push(i)}return{steps:t,timing:Object.assign(Object.assign({},u(n)),e.timing)}},v=e=>{if(!e.shake)return{steps:[],timing:u(1)};const n=Math.floor(e.shake.velocity*e.timing.duration/1e3)+1,t=[];for(let a=0;a<n;++a){const r=g(e,a/n)*e.shake.amplitudeX*100,l=g(e,a/n)*e.shake.amplitudeY*100,i={};i.transform=`translate3d(${r}%, ${l}%, 0)`,t.push(i)}return{steps:t,timing:Object.assign(Object.assign({},u(n)),e.timing)}},y=e=>{const n=[];if(n.push(v(e)),e.slice)for(let t=0;t<e.slice.count;++t)n.push(M(e));return n},p=(e,n,t,a)=>{const r=document.createElement("div");for(r.classList.add("layer"),r.style.backgroundColor=t.backgroundColor,r.style.backgroundRepeat="no-repeat",r.style.backgroundPosition="center",r.style.backgroundSize="contain",r.style.width="100%",r.style.height="100%",r.style.top="0",r.style.left="0",r.style.position="absolute",e.style.position="relative",t.hideOverflow?e.style.overflow="hidden":e.style.overflow="visible";e.firstChild;)e.removeChild(e.firstChild);for(const l of n){const i=r.cloneNode(!1);i.style.backgroundImage=`url(${a})`,i.animate(l.steps,l.timing),e.appendChild(i)}};function b(...e){const n=t=>t&&typeof t=="object";return e.reduce((t,a)=>(Object.keys(a).forEach(r=>{const l=t[r],i=a[r];if(Array.isArray(l)&&Array.isArray(i)){t[r]=l.concat(...i);return}if(n(l)&&n(i)){t[r]=b(l,i);return}i!==void 0&&(t[r]=i)}),t),{})}const C=(e=".powerglitch",n={})=>{const t=b(d(),n);let a=[];if(typeof e=="string"){const o=document.querySelectorAll(e);if(!o.length)throw new Error(`Could not find any element with selector ${e}`);a=Array.from(o)}else a=[e];const r=a.filter(o=>o instanceof HTMLImageElement),l=a.filter(o=>o instanceof HTMLDivElement),i=y(t);for(const o of r){const h=document.createElement("div");if(h.style.width=o.clientWidth+"px",h.style.height=o.clientHeight+"px",!o.parentElement)throw new Error("Unable to glitch image, it is not attached to a parent element");o.parentElement.insertBefore(h,o),o.style.display="none",p(h,i,t,t.imageUrl||o.src)}for(const o of l){if(!t.imageUrl)throw new Error("Options.imageUrl must be set if there are div elements to glitch");p(o,i,t,t.imageUrl)}};f=m.PowerGlitch={glitch:C,generateLayers:y,getDefaultOptions:d};const w=s.defineComponent({__name:"GlitchedImage",props:{imageUrl:{type:String,required:!0},options:{type:Object,required:!1,default:()=>({})}},setup(e){const n=e,t=s.ref(null);return s.onMounted(()=>{f.glitch(t.value,{...n.options,imageUrl:n.imageUrl})}),(a,r)=>(s.openBlock(),s.createElementBlock("div",{ref_key:"glitched",ref:t},null,512))}}),k={install:e=>{e.component("GlitchedImage",w)}};return c.GlitchedImage=w,c.default=k,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),c}({},Vue);
